table = {
    "cowpea beetle": r"Callosobruchus maculatus",
    "bean beetle": r"Callosobruchus maculatus",
    "confused flour beetle": r"Tribolium confusum",
    "mealworm": r"Tenebrio molitor larvae",
    "darkling beetle": r"Tenebrio molitor",
    "corn flakes": r"Zea mays (Corn Flakes)",
    "white rice": r"Oryza sativa (White rice)",
    "rice": r"Oryza sativa (White rice)",
    "corn meal": r"Zea mays (Cornmeal)",
    "oatmeal": r"Avena sativa (Oatmeal)",
    "wheat groats": r"Triticum aestivum (Wheat groats)",
    "flour": r"Triticum aestivum (Flour)",
    "maggot": r"Musca domestica (larvae)",
    "earthworm": r"Lumbricus terrestris",
    "cowpeas": r"Vigna unguiculata",
    "callosobruchus maculatus": r"Cowpea beetle",
    "tribolium confusum": r"Confused flour beetle",
    "tenebrio molitor (larvae)": r"Mealworm",
    "tenebrio molitor larvae": r"Mealworm",
    "tenebrio molitor": r"Darkling beetle",
    "musca domestica (larvae)": r"Maggot",
    "lumbricus terrestris": r"Earthworm",
    "vigna unguiculata": r"Cowpeas",
    "oryza sativa": r"Rice",
    "zea mays": r"Corn Meal",
    "avena sativa": r"Oatmeal",
    "triticum aestivum": r"Wheat",
}

table_min = {
    "cowpea beetle": r"C. maculatus",
    "bean beetle": r"C. maculatus",
    "confused flour beetle": r"T. confusum",
    "mealworm": r"T. molitor larvae",
    "darkling beetle": r"T. molitor",
    "corn flakes": r"Corn Flakes",
    "white rice": r"O. sativa",
    "rice": r"O. sativa",
    "corn meal": r"Z. mays",
    "oatmeal": r"A. sativa",
    "wheat groats": r"T. aestivum",
    "flour": r"T. aestivum",
    "maggot": r"M. domestica (larvae)",
    "earthworm": r"L. terrestris",
    "cowpeas": r"V. unguiculata",
    "callosobruchus maculatus": r"C. maculatus",
    "tribolium confusum": r"T. confusum",
    "tenebrio molitor (larvae)": r"T. molitor larvae",
    "tenebrio molitor larvae": r"T. molitor larvae",
    "tenebrio molitor": r"T. molitor",
    "musca domestica (larvae)": r"M. domestica larvae",
    "musca domestica larvae": r"M. domestica larvae",
    "lumbricus terrestris": r"L. terrestris",
    "vigna unguiculata": r"V. unguiculata",
    "oryza sativa": r"O. sativa",
    "zea mays": r"Z. mays",
    "avena sativa": r"A. sativa",
    "triticum aestivum": r"T. aestivum",
}

table_latex = {
    "cowpea beetle": r"$\it{Callosobruchus}$ $\it{maculatus}$",
    "bean beetle": r"$\it{Callosobruchus}$ $\it{maculatus}$",
    "confused flour beetle": r"$\it{Tribolium}$ $\it{confusum}$",
    "mealworm": r"$\it{Tenebrio}$ $\it{molitor}$ larvae",
    "darkling beetle": r"$\it{Tenebrio}$ $\it{molitor}$",
    "corn flakes": r"$\it{Zea}$ $\it{mays}$",
    "white rice": r"$\it{Oryza}$ $\it{sativa}$",
    "rice": r"$\it{Oryza}$ $\it{sativa}$",
    "corn meal": r"$\it{Zea}$ $\it{mays}$",
    "oatmeal": r"$\it{Avena}$ $\it{sativa}$",
    "wheat groats": r"$\it{Triticum}$ $\it{aestivum}$",
    "flour": r"$\it{Triticum}$ $\it{aestivum}$",
    "maggot": r"$\it{Musca}$ $\it{domestica}$ (larvae)",
    "earthworm": r"$\it{Lumbricus}$ $\it{terrestris}$",
    "cowpeas": r"$\it{Vigna}$ $\it{unguiculata}$",
    "callosobruchus maculatus": r"$\it{Callosobruchus}$ $\it{maculatus}$",
    "tribolium confusum": r"$\it{Tribolium}$ $\it{confusum}$",
    "tenebrio molitor (larvae)": r"$\it{Tenebrio}$ $\it{molitor}$ larvae",
    "tenebrio molitor larvae": r"$\it{Tenebrio}$ $\it{molitor}$ larvae",
    "tenebrio molitor": r"$\it{Tenebrio}$ $\it{molitor}$",
    "musca domestica (larvae)": r"$\it{Musca}$ $\it{domestica}$ larvae",
    "lumbricus terrestris": r"$\it{Lumbricus}$ $\it{terrestris}$",
    "vigna unguiculata": r"$\it{Vigna}$ $\it{unguiculata}$",
    "oryza sativa": r"$\it{Oryza}$ $\it{sativa}$",
    "zea mays": r"$\it{Zea}$ $\it{mays}$",
    "avena sativa": r"$\it{Avena}$ $\it{sativa}$",
    "triticum aestivum": r"$\it{Triticum}$ $\it{aestivum}$",
}

table_latex_min = {
    "cowpea beetle": r"$\it{C.}$ $\it{maculatus}$",
    "bean beetle": r"$\it{C.}$ $\it{maculatus}$",
    "confused flour beetle": r"$\it{T.}$ $\it{confusum}$",
    "mealworm": r"$\it{T.}$ $\it{molitor}$ larvae",
    "darkling beetle": r"$\it{T.}$ $\it{molitor}$",
    "corn flakes": r"$\it{Z.}$ $\it{mays}$",
    "white rice": r"$\it{O.}$ $\it{sativa}$",
    "rice": r"$\it{O.}$ $\it{sativa}$",
    "corn meal": r"$\it{Z.}$ $\it{mays}$",
    "oatmeal": r"$\it{A.}$ $\it{sativa}$",
    "wheat groats": r"$\it{T.}$ $\it{aestivum}$",
    "flour": r"$\it{T.}$ $\it{aestivum}$",
    "maggot": r"$\it{M.}$ $\it{domestica}$ (larvae)",
    "earthworm": r"$\it{L.}$ $\it{terrestris}$",
    "cowpeas": r"$\it{V.}$ $\it{unguiculata}$",
    "callosobruchus maculatus": r"$\it{C.}$ $\it{maculatus}$",
    "tribolium confusum": r"$\it{T.}$ $\it{confusum}$",
    "tenebrio molitor (larvae)": r"$\it{T.}$ $\it{molitor}$ larvae",
    "tenebrio molitor larvae": r"$\it{T.}$ $\it{molitor}$ larvae",
    "tenebrio molitor": r"$\it{T.}$ $\it{molitor}$",
    "musca domestica (larvae)": r"$\it{M.}$ $\it{domestica}$ larvae",
    "musca domestica larvae": r"$\it{M.}$ $\it{domestica}$ larvae",
    "lumbricus terrestris": r"$\it{L.}$ $\it{terrestris}$",
    "vigna unguiculata": r"$\it{V.}$ $\it{unguiculata}$",
    "oryza sativa": r"$\it{O.}$ $\it{sativa}$",
    "zea mays": r"$\it{Z.}$ $\it{mays}$",
    "avena sativa": r"$\it{A.}$ $\it{sativa}$",
    "triticum aestivum": r"$\it{T.}$ $\it{aestivum}$",
}

def lookup(key: str, latex:bool=False, min:bool=False) -> str:
    """
    Lookup function for the SPI database.

    Args:
        key (str): lookup key
        latex (bool, optional): LaTeX formatting. Defaults to False.
        min (bool, optional): Scientific name shortening. Defaults to False.

    Returns:
        str: _description_
    """
    key = key.lower()

    if latex: 
        if min:
            return table_latex_min[key]
        else:
            return table_latex[key]
    else:
        if min:
            return table_min[key]
        else:
            return table[key]
        